
Dim Page As Object
Dim GraphicObjectShape As Object
Dim Point As New com.sun.star.awt.Point
Dim Size As New com.sun.star.awt.Size

Sub Main
 	displayMatrix(generateSinglePattern)

End Sub

Function genDot(x as Integer, y as Integer)

	Doc = ThisComponent
	Page = Doc.drawPage
	
	GraphicObjectShape = Doc.createInstance("com.sun.star.drawing.GraphicObjectShape")
	Size.Width = 1000 'Grösse
	Size.Height = 1000 'Grösse
	GraphicObjectShape.Size = Size	
	Point.x = x 'Position   
	Point.y = y 'Position
	GraphicObjectShape.Position = Point	
	GraphicObjectShape.GraphicURL = *******FILEPATH*******
	GraphicObjectShape.AnchorType=0
	GraphicObjectShape.IsFollowingTextFlow (true)
	GraphicObjectShape.GraphicColorMode = com.sun.star.drawing.ColorMode.STANDARD
	Page.add(GraphicObjectShape)
End Function

Function displayMatrix(Array)
	For x=0 To 15
			For y=0 To 7
				if Array(x,y) THEn
					genDot(x*1000,y*1000)
				EndIf
			Next y
	Next x
End Function

Dim matrix(15,7) As Boolean		REM matrix with single pattern

Function generateSinglePattern
	Doc = ThisComponent
	Page = Doc.drawPage
	
	FOR sepRow = 0 To 7				REM Setting seperator column
		matrix(9,sepRow)=true		Rem every number in the ninth column is set to 1
	Next



	matrix(0,0)=true
	setValueToBin(1,MINUTE(NOW)+RandomInt(-10,10)) REM 7:minute
	setValueToBin(4,HOUR(NOW)) REM HOUR
	setValueToBin(5,DAY(NOW)) REM day
	setValueToBin(6,MONTH(NOW)) REM MONTH
	setValueToBin(7,YEAR(NOW)-2000) REM YEAR
	For i=10 To 15 
		setValueToBin(i,RandomInt(0,127))
	NEXT
	For i=1 To 7                 REM parity row
		Dim s As Integer
		s=0
		For j=1 To 15
			s=s+matrix(j,i)
		Next j
		
		IF int(s / 2) = s/2 THEN
			matrix(0,i)=true
		EndIf
	Next i
	For i=1 To 15

		s=0
		For j=1 To 7
			s=s+matrix(i,j)
		Next j
		If int(s/2)=s/2 THEN
			matrix(i,0)=true
		Endif
	Next i
	
	generateSinglePattern=matrix
	
End Function

Function setValueToBin(column as Integer, value as Integer)
	Dim x as Integer
	x = value
	For i = 6 To -1 Step -1
		IF 2^i<=x THEN
		x=x-2^i
		matrix(column,-i+7)=true
		End If
	Next
End Function

Function RandomInt(startVal as Integer, endVal as Integer)
	RandomInt = int((endVal-startVal)*Rnd+startVal)
End Function